{
  "test_suite": "fin_chatbot_smoke_suite",
  "version": "2.0",
  "description": "Deterministic smoke suite for fin_chatbot accuracy testing (scalar tests only)",
  "as_of_date": "2026-01-03",
  "baseline": {
    "total_transactions": 46,
    "date_range_start": "2025-10-25",
    "date_range_end": "2026-01-03",
    "currency": "CZK"
  },
  "database": {
    "server": "sqlsrv-finazcore251027-dev-neu.database.windows.net",
    "database": "sqldb-finazcore251027-dev",
    "table": "Transactions"
  },
  "test_cases": [
    {
      "id": "smoke_001",
      "category": "counting",
      "question": "How many transactions do I have?",
      "sql_validation": "SELECT COUNT(*) as cnt FROM Transactions",
      "expected_value": 46,
      "expected_format": "number",
      "notes": "Basic count - should match exactly"
    },
    {
      "id": "smoke_002",
      "category": "aggregation",
      "question": "What is my net balance?",
      "sql_validation": "SELECT SUM(Amount) as net FROM Transactions",
      "expected_value": 4604.81,
      "expected_format": "currency",
      "notes": "Sum of ALL amounts (income + expenses). Result should be reported as '4,604.81 CZK'"
    },
    {
      "id": "smoke_003",
      "category": "aggregation",
      "question": "What is my total income?",
      "sql_validation": "SELECT SUM(Amount) as income FROM Transactions WHERE Amount > 0",
      "expected_value": 261653.00,
      "expected_format": "currency",
      "notes": "Sum of positive amounts. Should report as '261,653.00 CZK'"
    },
    {
      "id": "smoke_004",
      "category": "aggregation",
      "question": "What is my total spending?",
      "sql_validation": "SELECT SUM(Amount) as spending FROM Transactions WHERE Amount < 0",
      "expected_value": -257048.19,
      "expected_format": "currency",
      "notes": "SQL returns negative (-257,048.19). Chatbot SHOULD report positive ('257,048.19 CZK spent') or accept negative with correct currency. FAIL if uses '$' instead of 'CZK'."
    },
    {
      "id": "smoke_005",
      "category": "aggregation",
      "question": "What was my largest expense?",
      "sql_validation": "SELECT MIN(Amount) as largest_expense FROM Transactions WHERE Amount < 0",
      "expected_value": -230000.00,
      "expected_format": "currency",
      "notes": "MIN because expenses are negative. Most negative = largest expense. Chatbot should report '230,000.00 CZK' (positive) or '-230,000.00 CZK' (negative with correct currency)."
    },
    {
      "id": "smoke_006",
      "category": "aggregation",
      "question": "What was my largest income?",
      "sql_validation": "SELECT MAX(Amount) as largest_income FROM Transactions WHERE Amount > 0",
      "expected_value": 233653.00,
      "expected_format": "currency",
      "notes": "MAX of positive amounts. Should report '233,653.00 CZK'"
    },
    {
      "id": "smoke_007",
      "category": "aggregation",
      "question": "What is my average transaction amount?",
      "sql_validation": "SELECT AVG(Amount) as avg_amount FROM Transactions",
      "expected_value": 100.10,
      "expected_format": "currency",
      "notes": "Average of ALL transactions. Expected: 4604.81 / 46 ≈ 100.10 CZK. Tolerance ±0.50"
    },
    {
      "id": "smoke_008",
      "category": "date_filtering",
      "question": "How many transactions did I have in December 2025?",
      "sql_validation": "SELECT COUNT(*) as cnt FROM Transactions WHERE TransactionDate >= '2025-12-01' AND TransactionDate < '2026-01-01'",
      "expected_value": 26,
      "expected_format": "number",
      "notes": "Deterministic date range. December 2025 only. Verified actual value: 26 transactions."
    },
    {
      "id": "smoke_009",
      "category": "account_filtering",
      "question": "How many transactions are in the spending account in December 2025?",
      "sql_validation": "SELECT COUNT(*) as cnt FROM Transactions WHERE AccountID = 'spending' AND TransactionDate >= '2025-12-01' AND TransactionDate < '2026-01-01'",
      "expected_value": 22,
      "expected_format": "number",
      "notes": "Tests AccountID filtering. User says 'spending account' → SQL must use WHERE AccountID = 'spending'. Common failure: using 'invoices' instead."
    }
  ]
}
